I1216 20:03:19.989559 140233231890176 file_utils.py:40] PyTorch version 1.1.0 available.
I1216 20:03:21.493631 140233231890176 tokenization_utils.py:379] loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
I1216 20:03:49.748951 140233231890176 configuration_utils.py:157] loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-uncased-config.json from cache at /root/.cache/torch/transformers/a41e817d5c0743e29e86ff85edc8c257e61bc8d88e4271bb1b243b6e7614c633.1ccd1a11c9ff276830e114ea477ea2407100f4a3be7bdc45d37be9e37fa71c7e
I1216 20:03:49.749690 140233231890176 configuration_utils.py:174] Model config {
  "activation": "gelu",
  "attention_dropout": 0.1,
  "dim": 768,
  "dropout": 0.1,
  "finetuning_task": null,
  "hidden_dim": 3072,
  "initializer_range": 0.02,
  "is_decoder": false,
  "max_position_embeddings": 512,
  "n_heads": 12,
  "n_layers": 6,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pruned_heads": {},
  "qa_dropout": 0.1,
  "seq_classif_dropout": 0.2,
  "sinusoidal_pos_embds": false,
  "tie_weights_": true,
  "torchscript": false,
  "use_bfloat16": false,
  "vocab_size": 30522
}

I1216 20:03:50.580904 140233231890176 modeling_utils.py:393] loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/distilbert-base-uncased-pytorch_model.bin from cache at /root/.cache/torch/transformers/7b8a8f0b21c4e7f6962451c9370a5d9af90372a5f64637a251f2de154d0fc72c.c2015533705b9dff680ae707e205a35e2860e8d148b45d35085419d74fe57ac5
{'N': 6,
 'aggregation': 'cat',
 'allow_empty_images': False,
 'batch_sizes': (12, 12, 12),
 'cache_image_vectors': True,
 'ckpt_name': None,
 'ckpt_path': PosixPath('/workhere/vtt_challenge_2019/code/data/ckpt'),
 'continue_training': False,
 'd_ff': 512,
 'data_path': PosixPath('/workhere/vtt_challenge_2019/code/data/AnotherMissOh/AnotherMissOh_QA/AnotherMissOhQA_set_subtitle.jsonl'),
 'device': 'cuda',
 'dropout': 0.5,
 'dropout_tr': 0.1,
 'eps': 1e-08,
 'extractor_batch_size': 384,
 'feature_pooling_method': 'mean',
 'gamma': 0.5,
 'h': 8,
 'image_dim': 512,
 'image_path': PosixPath('/workhere/vtt_challenge_2019/code/data/AnotherMissOh/AnotherMissOh_images'),
 'layers': 3,
 'learning_rate': 0.01,
 'log_cmd': False,
 'log_path': PosixPath('/workhere/vtt_challenge_2019/code/data/log'),
 'loss_name': 'cross_entropy_loss',
 'lower': True,
 'lrschedule': 'lin',
 'max_epochs': 20,
 'metrics': [],
 'min_lr': 1e-08,
 'mode': 'min',
 'model_name': 'twopunch',
 'multichoice': True,
 'n_dim': 512,
 'nsample': 8,
 'num_workers': 40,
 'optimizer': 'adam',
 'patience': 2,
 'pretrained_ep': 0,
 'random_seed': 0,
 'rel_positional_emb': 4,
 'subtitle_path': PosixPath('/workhere/vtt_challenge_2019/code/data/AnotherMissOh/AnotherMissOh_subtitles.json'),
 'text_feature_names': ['subtitle', 'description'],
 'threshold': 0.001,
 'threshold_mode': 'rel',
 'tokenizer': 'distilbert',
 'use_inputs': ['images', 'subtitle'],
 'video_type': ['shot', 'scene'],
 'vocab_freq': 1,
 'warmup_steps': 2000}
Loading Text Data
using ['shot', 'scene'] videoType
Loading Image Data
Loading Image Cache
total vids: 10367
Loading Image Cache
total vids: 1433
Loading Image Cache
total vids: 1445
Data Loading Done
Traceback (most recent call last):
  File "cli.py", line 101, in <module>
    Fire(Cli)
  File "/root/anaconda3/envs/dl/lib/python3.6/site-packages/fire/core.py", line 127, in Fire
    component_trace = _Fire(component, args, context, name)
  File "/root/anaconda3/envs/dl/lib/python3.6/site-packages/fire/core.py", line 366, in _Fire
    component, remaining_args)
  File "/root/anaconda3/envs/dl/lib/python3.6/site-packages/fire/core.py", line 542, in _CallCallable
    result = fn(*varargs, **kwargs)
  File "cli.py", line 47, in train
    train(args)
  File "/workhere/vtt_challenge_2019/code/train.py", line 58, in train
    lrsch = get_scheduler(args, optimizer, len_train)
  File "/workhere/vtt_challenge_2019/code/lrschedulers.py", line 38, in get_scheduler
    ws,
NameError: name 'ws' is not defined

If you suspect this is an IPython bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

